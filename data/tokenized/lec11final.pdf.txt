CPSC 420 Lecture 11: Today’s announcements:
▶ HW2 is on Gradescope, due Feb 9, 23:59
▶ Examlet 2 on Feb 17 in class. Closed book & no notes
▶ Reading: Ch.10 Maximum Flows & Minimum Cuts
Ch.11 Applications of Flows and Cuts
Ch.H Linear Programming [all by Erickson]
Today’s Plan
▶ Network Flow
▶ Open Pit Mining
▶ Linear programming duality
1 / 10

Open Pit Mining
Imagine the earth is a lattice of cubes.
Every cube has a value (think “gold” minus “cost” to process)
Constraint: must remove some cubes before others (think cave-in)
Input: Directed acyclic graph G = (V , E). V = set of cubes
E = {(u, v)|u must be removed before v}
w(v) = value of cube v
A
B
C
D
E
F
G
H
I
-1
-2
-1
+1
-3
-2
+1
+5
+2
Find most profitable set of cubes to process but obey constraints.
2 / 10

Maximum Value Initial Set
Convert the vertex-valued directed graph G = (V , E) into a flow
network so that
A. Any finite capacity cut corresponds to an initial set.
B. A min capacity cut corresponds to a max value initial set.
1. Add source s and sink t
2. Set capacity c(u, v) = ∞ for (u, v) ∈ E
3. Create an edge (s, v) or (v, t) for every v ∈ V with finite
capacity (to be determined)
A
B
C
D
E
F
G
H
I
∞
∞
∞
∞
∞
∞
∞
∞
s
t
-1
-2
-1
+1
-3
-2
+1
+5
+2
3 / 10

Maximum Value Initial Set
A
B
C
D
E
F
G
H
I
∞
∞
∞
∞
∞
∞
∞
∞
s
t
-1
-2
-1
+1
-3
-2
+1
+5
+2
Claim: In this network any finite capacity cut (S, T) defines an
initial set T − t (and vice-versa).
Proof: If cut (S, T) has finite capacity then no original edges are
directed into T from S so T − t is an initial set.
If U ⊆ V is initial then cut (S = (V − U) + s, T = U + t) has
finite capacity. Only edges (s, u)|u ∈ T and (v, t)|v ∈ S cross the
cut from S to T (and they have finite capacity).
□
How do we set capacities on the edges from s and edges to t so
minimum capacity cut yields maximum value initial set?
4 / 10

Maximum Value Initial Set
Idea If w(u) > 0, increase cut capacity if we don’t take u (u ̸∈ T).
If w(v) < 0, increase cut capacity if we do take v (v ∈ T).
v
u
-1
+3
∞
s
t
1
3
Final flow network
A
B
C
D
E
F
G
H
I
∞
∞
∞
∞
∞
∞
∞
∞
s
t
1
2
1
2
1
1
5
2
3
5 / 10

Maximum Value Initial Set
For any initial set U, the capacity of the corresponding cut
(S = (V − U) + s, T = U + t) is
c(S, T) =
�
u̸∈U
w(u)>0
w(u) +
�
v∈U
w(v)<0
−w(v)
profit =
�
u∈U
w(u)>0
w(u) +
�
v∈U
w(v)<0
w(v)
To maximize profit, minimize (over cuts (S, T), which define U)
�
u∈V
w(u)>0
w(u) − profit =
�
u̸∈U
w(u)>0
w(u) −
�
v∈U
w(v)<0
w(v) = c(S, T)
6 / 10

Linear Programming Duality
max x1 + 6x2
x1 ≤ 200
x2 ≤ 300
x1 + x2 ≤ 400
x1, x2 ≥ 0
Solution
x1 = 100, x2 = 300
with value 1900.
How can we verify this? Can we show x1 + 6x2 ≤ 1900 for all
feasible x1, x2?
Multiply inequalities by 0, 5, 1 and add them together:
0×
(x1 ≤ 200)
+5×
(x2 ≤ 300)
+1×
(x1 + x2 ≤ 400)
=
x1 + 6x2 ≤ 1900
How did I determine these coefficients?
7 / 10

Linear Programming Duality
Multiply inequalities by y1, y2, y3 and add them together:
y1×
(x1 ≤ 200)
+y2×
(x2 ≤ 300)
+y3×
(x1 + x2 ≤ 400)
=
(y1 + y3)x1 + (y2 + y3)x2 ≤ 200y1 + 300y2 + 400y3
1. yi’s must be non-negative (or inequality flips).
y1, y2, y3 ≥ 0
2. 200y1 + 300y2 + 400y3 is an upper bound on x1 + 6x2 if
y1 + y3 ≥ 1 and y2 + y3 ≥ 6
3. Choose the yi’s to obtain the best upper bound.
minimize 200y1 + 300y2 + 400y3
8 / 10

Linear Programming Duality
x1 + 6x2 ≤ 200y1 + 300y2 + 400y3
for all x1 ≤ 200
for all y1 + y3 ≥ 1
x2 ≤ 300
y2 + y3 ≥ 6
x1 + x2 ≤ 400
x1, x2 ≥ 0
y1, y2, y3 ≥ 0
The objective value of any feasible solution of the dual LP is an
upper bound on the objective value of any feasible solution of the
primal LP.
Duality Theorem If LP has bounded optimum then so does its dual
and the two optimum values are the same.
9 / 10

Duality in general
max c1x1 + · · · + cnxn
min b1y1 + · · · + bmym
ai,1x1 + · · · + ai,nxn ≤ bi
a1,jy1 + · · · + am,jym ≥ cj
xj ≥ 0
yi ≥ 0
i = 1 . . .m j = 1 . . . n
i = 1 . . .m j = 1 . . . n
10 / 10